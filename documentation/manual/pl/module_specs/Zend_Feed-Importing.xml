<sect1 id="zend.feed.importing">

    <title>Importowanie kanałów informacyjnych</title>

    <para>
        <code>Zend_Feed</code> pozwala programistom bardzo łatwo odbierać wiadomości
        z kanałów informacyjnych. Jeśli znasz adres URI kanału, w prosty sposób
        użyj metody <code>Zend_Feed::import()</code>:
    </para>

    <programlisting role="php"><![CDATA[<?php
$feed = Zend_Feed::import('http://feeds.example.com/feedName');]]></programlisting>

    <para>
        Możesz także użyć <code>Zend_Feed</code> do pobrania zawartości kanału
        z pliku lub z łańcucha znaków PHP:
    </para>

    <programlisting role="php"><![CDATA[<?php
// importowanie kanału z pliku tekstowego
$feedFromFile = Zend_Feed::importFile('feed.xml');

// importowanie kanału z łańcucha znaków PHP
$feedFromPHP = Zend_Feed::importString($feedString);]]></programlisting>

    <para>
        We wszystkich powyższych przykładach w razie powodzenia operacji zwracany
        jest obiekt klasy rozszerzającej <code>Zend_Feed_Abstract</code>, zależenie
        od typu kanału. Jeśli zostały odebrane dane RSS za pomocą jednej z powyższych
        metod importu, wtedy będzie zwrócony obiekt <code>Zend_Feed_Rss</code>. 
        Z drugiej strony, gdy będą importowane dane kanału Atom, zwrócony zostanie
        obiekt <code>Zend_Feed_Atom</code>. Metody importu w razie niepowodzenia
        wyrzucają wyjątek <code>Zend_Feed_Exception</code>, czyli na przykład wtedy
        gdy nie jest możliwe odczytanie kanału lub gdy dane są błędne.
    </para>

    <sect2 id="zend.feed.importing.custom">

        <title>Własne kanały</title>

        <para>
            <code>Zend_Feed</code> pozwala programistom na bardzo łatwe 
            tworzenie własnych kanałów. Musisz jedynie utworzyć tablicę i 
            zaimportować ją za pomocą Zend_Feed. Ta tablica może być 
            zaimportowana za pomocą metody <code>Zend_Feed::importArray()</code>
            lub <code>Zend_Feed::importBuilder()</code>. W tym drugim przypadku 
            tablica zostanie utworzona w locie, przez własne źródło danych 
            implementujące interfejs <code>Zend_Feed_Builder_Interface</code>.
        </para>

        <sect3 id="zend.feed.importing.custom.importarray">

            <title>Importowanie własnej tablicy</title>

            <programlisting role="php"><![CDATA[<?php
// importowanie kanału z tablicy
$atomFeedFromArray = Zend_Feed::importArray($array);

// poniższy kod odpowiada kodowi powyżej; domyślnie zwracana jest instancja Zend_Feed_Atom
$atomFeedFromArray = Zend_Feed::importArray($array, 'atom');

// importowanie kanału rss z tablicy
$rssFeedFromArray = Zend_Feed::importArray($array, 'rss');]]></programlisting>

            <para>
                Format tablicy musi zgadzać się z taką strukturą:
            </para>

            <programlisting role="php"><![CDATA[<?php
array(
      'title'       => 'tytuł kanału', //wymagane
      'link'        => 'adres url kanału', //wymagane
      'lastUpdate'  => 'timestamp of the update date', // opcjonalne
      'published'   => 'timestamp of the publication date', //opcjonalne
      'charset'     => 'zestaw znaków dla danych tekstowych', // wymagane
      'description' => 'krótki opis kanału', //opcjonalne
      'author'      => 'autor kanału', //opcjonalne
      'email'       => 'adres email autora', //opcjonalne
      'webmaster'   => 'adres osoby odpowiedzialnej za sprawy techniczne' // opcjonalne, ignorowane jeśli używany jest atom
      'copyright'   => 'informacje o prawach autorskich', //opcjonalne
      'image'       => 'adres obrazka', //opcjonalne
      'generator'   => 'generator', // opcjonalne
      'language'    => 'język w jakim publikowany jest kanał', // opcjonalne
      'ttl'         => 'na jak długo, w minutach, kanał może być buforowany przed odświeżeniem', // opcjonalne, ignorowane jeśli używany jest atom
      'rating'      => 'The PICS rating for the channel.', // opcjonalne, ignorowane jeśli używany jest atom
      'cloud'       => array(
                             'domain'            => 'domain of the cloud, np. rpc.sys.com' // wymagane
                             'port'              => 'port to connect to' // opcjonalne, domyślnie wartość 80
                             'path'              => 'path of the cloud, np. /RPC2' //wymagane
                             'registerProcedure' => 'procedura do wywołania, np. myCloud.rssPleaseNotify' // wymagane
                             'protocol'          => 'protokół do użycia, np. soap lub xml-rpc' // wymagane
                             ), // a cloud to be notified of updates // opcjonalne, ignorowane jeśli używany jest atom
      'textInput'   => array(
                             'title'       => 'etykieta przycisku wysyłającego treść pola tekstowego' // wymagane,
                             'description' => 'wyjaśnienie przeznaczenia pola tekstowego' // wymagane
                             'name'        => 'the name of the text object in the text input area' // wymagane
                             'link'        => 'adres URL skryptu CGI który przetwarza wysłaną treść' // wymagane
                             ) // pole tekstowe które może być wyświetlone wraz z kanałem // opcjonalne, ignorowane jeśli używany jest atom
      'skipHours'   => array(
                             'godzina do pominięcia w formacie 24 godzinnym', // np. 13 (1pm)
                             // do 24 wierszy których wartościami mogą być numery między 0 a 23
                             ) // Wskazówka mówiąca agregatorom które godziny mogą pominąć // opcjonalne, ignorowane jeśli używany jest atom
      'skipDays '   => array(
                             'dzień do pominięcia', // np. Monday
                             // do 7 wierszy, których wartościami mogą być Monday, Tuesday, Wednesday, Thursday, Friday, Saturday lub Sunday
                             ) // Wskazówka mówiąca agregatorom które dni mogą pominąć // opcjonalne, ignorowane jeśli używany jest atom
      'itunes'      => array(
                             'author'       => 'Artist column' // opcjonalne, domyślnie wartość z pola author
                             'owner'        => array(
                                                     'name' => 'nazwa właściciela' // opcjonalne, domyślnie wartość z głównego pola author
                                                     'email' => 'adres email właściciela' // opcjonalne, domyślnie wartość z głównego pola email
                                                     ) // właściciel podcasta // opcjonalne
                             'image'        => 'obrazek albumu/podcasta' // opcjonalne, domyślnie wartość z głownego pola image
                             'subtitle'     => 'krótki opis' // opcjonalne, domyślnie wartość z głownego pola description
                             'summary'      => 'dłuższy opis' // opcjonalne, domyślnie wartość z głownego pola description
                             'block'        => 'Prevent an episode from appearing (yes|no)' // opcjonalne
                             'category'     => array(
                                                     array('main' => 'głowna kategoria', // wymagane
                                                           'sub'  => 'podkategoria' // opcjonalne
                                                           ),
                                                     // do 3 wierszy
                                                     ) // 'Category column and in iTunes Music Store Browse' // wymagane
                             'explicit'     => 'parental advisory graphic (yes|no|clean)' // opcjonalne
                             'keywords'     => 'lista maksymalnie 12 słów kluczowych oddzielonych przecinkami' // opcjonalne
                             'new-feed-url' => 'used to inform iTunes of new feed URL location' // opcjonalne
                             ) // Dane rozszerzenia Itunes // opcjonalne, ignorowane jeśli używany jest atom
      'entries'     => array(
                             array(
                                   'title'        => 'tytuł wpisu z kanału', //wymagane
                                   'link'         => 'adres do wpisu z kanału', //wymagane
                                   'description'  => 'krótka wersja wpisu z kanału', // jedynie tekst, bez html, wymagane
                                   'guid'         => 'identyfikator artykułu, jeśli nie podany, zostanie użyta wartość z pola link', //opcjonalne
                                   'content'      => 'długa wersja', // może zawierać html, opcjonalne
                                   'lastUpdate'   => 'timestamp of the publication date', // opcjonalne
                                   'comments'     => 'comments page of the feed entry', // opcjonalne
                                   'commentRss'   => 'the feed url of the associated comments', // opcjonalne
                                   'source'       => array(
                                                           'title' => 'tytuł oryginalnego źródła' // wymagane,
                                                           'url' => 'adres oryginalnego źródła' // wymagane
                                                           ) // oryginalne źródło wpisu z kanału // opcjonalne
                                   'category'     => array(
                                                           array(
                                                                 'term' => 'etykieta pierwszej kategorii' // wymagane,
                                                                 'scheme' => 'adres identyfikujący schemat kategoryzowania' // opcjonalne
                                                                 ),
                                                           array(
                                                                 // dane dla kolejnej kategorii itd.
                                                                 )
                                                           ) // lista powiązanych kategorii // opcjonalne
                                   'enclosure'    => array(
                                                           array(
                                                                 'url' => 'url of the linked enclosure' // wymagane
                                                                 'type' => 'mime type of the enclosure' // opcjonalne
                                                                 'length' => 'length of the linked content in octets' // opcjonalne
                                                                 ),
                                                           array(
                                                                 // data for the second enclosure and so on
                                                                 )
                                                           ) // list of the enclosures of the feed entry // opcjonalne
                                   ),
                             array(
                                   // dane dla drugiego wpisu itd.
                                   )
                             )
       );]]></programlisting>

            <para>
                References:
                <itemizedlist>
                    <listitem>
                        <para>
                            Specyfikacja RSS 2.0: <ulink url="http://blogs.law.harvard.edu/tech/rss">RSS 2.0</ulink>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            Specyfikacja Atom: <ulink url="http://tools.ietf.org/html/rfc4287">RFC 4287</ulink>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            Specyfikacja WFW: <ulink url="http://wellformedweb.org/news/wfw_namespace_elements">Well
                            Formed Web</ulink>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            Specyfikacja iTunes:
                            <ulink url="http://www.apple.com/itunes/store/podcaststechspecs.html">Specyfikacja 
                            Techniczna iTunes</ulink>
                        </para>
                    </listitem>
                </itemizedlist>
            </para>

        </sect3>

        <sect3 id="zend.feed.importing.custom.importbuilder">

            <title>Importowanie własnego źródła danych</title>

            <para>
                Możesz utworzyć instancję Zend_Feed z dowolnego źródła danych 
                implementując interfejs <code>Zend_Feed_Builder_Interface</code>. 
                Aby użyć swojego obiektu za pomocą metody 
                <code>Zend_Feed::importBuilder()</code> musisz po prostu 
                zaimplementować metody <code>getHeader()</code> oraz 
                <code>getEntries()</code>. Jako przykład implementacji możesz 
                użyć klasy <code>Zend_Feed_Builder</code>, która przyjmuje 
                tablicę jako argument konstruktora, przeprowadza pewną 
                walidację, a następnie może być użyta za pomocą metody 
                <code>importBuilder()</code>. Metoda <code>getHeader()</code> 
                musi zwracać instancję klasy 
                <code>Zend_Feed_Builder_Header</code>, a metoda 
                <code>getEntries()</code> musi zwracać tablicę instancji klasy
                <code>Zend_Feed_Builder_Entry</code>.
            </para>

            <note>
                <para>
                    <code>Zend_Feed_Builder</code> serves as a concrete 
                    implementation to demonstrate the usage. Users are encouraged 
                    to make their own classes to implement 
                    <code>Zend_Feed_Builder_Interface</code>.
                </para>
            </note>

            <para>
                Oto przykład użycia metody <code>Zend_Feed::importBuilder()</code>:
            </para>

            <programlisting role="php"><![CDATA[<?php
// importing a feed from a custom builder source
$atomFeedFromArray = Zend_Feed::importBuilder(new Zend_Feed_Builder($array));

// the following line is equivalent to the above; by default a Zend_Feed_Atom instance is returned
$atomFeedFromArray = Zend_Feed::importArray(new Zend_Feed_Builder($array), 'atom');

// importing a rss feed from a custom builder array
$rssFeedFromArray = Zend_Feed::importArray(new Zend_Feed_Builder($array), 'rss');]]></programlisting>

        </sect3>

        <sect3 id="zend.feed.importing.custom.dump">

            <title>Dumping the contents of a feed</title>

            <para>
                To dump the contents of a <code>Zend_Feed_Abstract</code> instance, 
                you may use <code>send()</code> or <code>saveXml()</code> methods.
            </para>

            <programlisting role="php"><![CDATA[<?php
assert($feed instanceof Zend_Feed_Abstract);

// dump the feed to standard output
print $feed->saveXML();

// send http headers and dump the feed
$feed->send();]]></programlisting>

        </sect3>

    </sect2>
    
</sect1>
<!--
vim:se ts=4 sw=4 et:
-->